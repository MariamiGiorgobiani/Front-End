<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart</title>
    <style>
        .catalog_jewellery { display: flex; flex-wrap: wrap; }
        .catalog_jewellery div { margin: 10px; padding: 20px; border: 1px solid #ddd; }
        .cart { margin-top: 10px; }
        .cart-list { margin-top: 20px; }
    </style>
</head>
<body>

    <h1>Product Catalog</h1>
    <div class="catalog_jewellery"></div>

    <h2>Your Cart:</h2>
    <ul class="cart-list">
        <!-- Cart items will be displayed here -->
    </ul>
    <button onclick="clearCart()">Clear Cart</button>



    <script>
let productsData = [];

// Fetch product data from the API
fetch('https://fakestoreapi.com/products')
    .then((resp) => resp.json())
    .then((data) => {
        productsData = data; // Store the data in the productsData variable
        getProducts(productsData); // Render products to the page
    })
    .catch((err) => {
        console.log(err);
        alert("Something went wrong");
    });

// Function to render products dynamically
const getProducts = (arr) => {
    let temp = "";

    arr.forEach((item) => {
        temp += `
            <div class="product" data-id="${item.id}">
                <img src="${item.image}" alt="${item.title}" width="100">
                <p>Category: ${item.category}</p>
                <p>Price: $${item.price}</p>
                <p>Ratings: ${item.rating.rate}</p>
                <button class="cart" onclick="addToCart(${item.id}, '${item.title}', ${item.price})">Add to Cart</button>
            </div>
        `;
    });

    document.querySelector('.catalog_jewellery').innerHTML = temp;
};

// Function to get the current cart from localStorage
const getCart = () => {
    const cart = localStorage.getItem('cart');
    return cart ? JSON.parse(cart) : [];
};

// Function to save the cart to localStorage
const saveCart = (cart) => {
    localStorage.setItem('cart', JSON.stringify(cart));
};

// Function to add an item to the cart
const addToCart = (id, title, price) => {
    let cart = getCart();

    // Check if the item already exists in the cart
    const existingItemIndex = cart.findIndex(item => item.id === id);
    if (existingItemIndex > -1) {
        // If item exists, update the quantity
        cart[existingItemIndex].quantity += 1;
    } else {
        // Otherwise, add a new item to the cart
        cart.push({ id, title, price, quantity: 1 });
    }

    // Save the updated cart to localStorage
    saveCart(cart);

    // Update the UI to reflect the cart
    displayCart();
};

// Function to display the cart in the UI
const displayCart = () => {
    const cart = getCart();
    const cartList = document.querySelector('.cart-list');
    cartList.innerHTML = ''; // Clear the list before re-rendering

    if (cart.length === 0) {
        cartList.innerHTML = '<li>Your cart is empty.</li>';
    } else {
        cart.forEach(item => {
            const li = document.createElement('li');
            li.textContent = `${item.title} - $${item.price} x ${item.quantity}`;
            const removeButton = document.createElement('button');
            removeButton.textContent = 'Remove';
            removeButton.onclick = () => removeFromCart(item.id);
            li.appendChild(removeButton);
            cartList.appendChild(li);
        });
    }
};

// Function to remove an item from the cart
const removeFromCart = (id) => {
    let cart = getCart();
    
    // Remove the item by id
    cart = cart.filter(item => item.id !== id);
    
    // Save the updated cart to localStorage
    saveCart(cart);
    
    // Update the UI to reflect the cart
    displayCart();
};

// Function to clear the cart
const clearCart = () => {
    saveCart([]); // Empty array clears the cart
    displayCart();
};

// On page load, display the cart from localStorage
window.onload = function() {
    displayCart(); // Display the cart from localStorage
};


    </script>
</body>
</html>
